#include "system.h"

static void oled_data(uint8_t data);
static void oled_clear(void);



static void oled_init(void);


const oled_operations_t oled_ops = {
    .data = oled_data,
    .clear = oled_clear,
    .word = LCD_P6x8Str,

};


const oled_device_t oled = {
    .init = oled_init,
    .ops = &oled_ops,
};



//======================================
const uint8_t oeld_char_lib6x8[][6] =
{
  { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp
  { 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !
  { 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "
  { 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #
  { 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $
  { 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %
  { 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &
  { 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '
  { 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (
  { 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )
  { 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *
  { 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +
  { 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,
  { 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -
  { 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .
  { 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /
  { 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0
  { 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1
  { 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2
  { 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3
  { 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4
  { 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5
  { 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6
  { 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7
  { 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8
  { 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9
  { 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :
  { 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;
  { 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <
  { 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =
  { 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >
  { 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?
  { 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @
  { 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A
  { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B
  { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C
  { 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D
  { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E
  { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F
  { 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G
  { 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H
  { 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I
  { 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J
  { 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K
  { 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L
  { 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M
  { 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N
  { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O
  { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P
  { 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q
  { 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R
  { 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S
  { 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T
  { 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U
  { 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V
  { 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W
  { 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X
  { 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y
  { 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z
  { 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [
  { 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55
  { 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]
  { 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^
  { 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _
  { 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '
  { 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a
  { 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b
  { 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c
  { 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d
  { 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e
  { 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f
  { 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g
  { 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h
  { 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i
  { 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j
  { 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k
  { 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l
  { 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m
  { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n
  { 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o
  { 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p
  { 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q
  { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r
  { 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s
  { 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t
  { 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u
  { 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v
  { 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w
  { 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x
  { 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y
  { 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z
  { 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }    // horiz lines
};


//开机画面
const uint8_t njustlogo[] = {
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xC0,0xE0,0x7E,0x7E,0x3C,0x30,0x20,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x0C,0x3C,0x3C,0x98,0x80,0x80,0x80,0xC0,0xC0,0x80,0x00,0x00,0x00,0x00,0x80,
0x80,0x80,0xC0,0xC0,0x00,0x00,0x00,0x30,0xB0,0x98,0x98,0x8C,0x0C,0x0C,0xF8,0x70,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,
0xF0,0x80,0x30,0x70,0xF0,0x40,0x40,0x20,0x38,0x1C,0x08,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0xC0,0xF0,0x70,0x30,0x18,0x0E,0x8F,0xF7,0xF6,0x76,0x7A,0x02,0x02,
0x02,0x02,0xCE,0xFC,0x00,0x00,0x00,0x00,0x08,0x08,0x0C,0x0C,0x04,0x86,0xE2,0x63,
0xB3,0xD3,0xC9,0xE9,0x19,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0xE0,0xA3,
0xA3,0xF3,0x7F,0x01,0x06,0x1F,0x1F,0xB8,0xFF,0x9F,0x9D,0x8C,0x0E,0x07,0x01,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x38,0x3C,0x1C,0x9C,0xFC,0x3C,0x08,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x18,0x98,0xFC,0xFE,0x9F,0x0F,
0x06,0x06,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0xF0,0x10,0x00,0x01,
0x01,0x04,0x04,0x92,0xFA,0xB9,0x11,0x01,0x01,0x09,0x0D,0x07,0x02,0x00,0x00,0x00,
0x00,0x00,0x00,0x0F,0x1F,0x1E,0x00,0x00,0x06,0x07,0x67,0x1F,0x03,0x30,0x30,0x30,
0x1C,0x06,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x10,0x18,0x38,
0x7F,0x0F,0x04,0x04,0x0C,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x1F,
0x1F,0x04,0x02,0x00,0x30,0x32,0x3B,0x1F,0x1F,0x19,0x31,0x30,0x30,0x10,0x00,0x00,
0x00,0x00,0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0E,0x0E,0x0F,0x07,0x07,0x07,0x07,
0x07,0x00,0x00,0x00,0x00,0x00,0x10,0x18,0x0C,0x0C,0x07,0x03,0x01,0x01,0x07,0x0F,
0x1E,0x3C,0x38,0x30,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x0C,0x0C,
0x46,0xC6,0x87,0xC3,0x37,0x1F,0x03,0x03,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x40,0x40,0xF8,0xF8,0x40,0x00,0xF8,0x10,0x70,0xB0,0x90,0x70,0x50,0x10,0xF0,0x00,
0x00,0x00,0x00,0x10,0xF8,0xF0,0x90,0xD0,0xB0,0x80,0xE0,0xB0,0x98,0x98,0xB0,0xA0,
0x60,0xC0,0xC0,0xC0,0x00,0x00,0x00,0x80,0xB0,0x30,0x20,0x40,0x50,0xD8,0x60,0x40,
0x40,0xB8,0x60,0xA0,0xA0,0xA0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,
0xF0,0xF0,0x90,0xD0,0xF0,0x10,0x00,0x00,0xF8,0x10,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x22,
0x22,0x63,0x33,0x3F,0x01,0x10,0x1B,0x0B,0x07,0x7F,0x7F,0x07,0x0F,0x19,0x30,0x10,
0x00,0x00,0x00,0x00,0x78,0x7F,0x08,0x04,0x07,0x20,0x24,0x2C,0x26,0x2C,0x30,0x2E,
0x26,0x20,0x20,0x00,0x00,0x00,0x00,0x09,0x09,0x29,0x15,0x18,0x27,0x31,0x1D,0x23,
0x22,0x62,0x63,0x3F,0x1E,0x02,0x06,0x06,0x02,0x00,0x00,0x02,0x03,0x01,0x01,0x01,
0x01,0x01,0x01,0x01,0x01,0x01,0x03,0x03,0x03,0x03,0x03,0x01,0x00,0x00,0x00,0x00,
0x7F,0x7F,0x24,0x24,0x37,0x32,0x1C,0x07,0x03,0x03,0x06,0x0C,0x18,0x38,0x30,0x10,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static void oled_data(uint8_t data)
{
  unsigned char i = 8;
  LCD_DC(1);
  LCD_SCL(0);
  delayus(1);    
  while(i--)
  {
    if(data&0x80)
      LCD_SDA(1);
    else
      LCD_SDA(0);
    LCD_SCL(1); 
    delayus(1);          
    LCD_SCL(0);    
    data<<=1;    
  }
}

void LCD_WrCmd(unsigned char cmd)
{
  unsigned char i=8;
  LCD_DC(0);
  LCD_SCL(0);
  delayus(1);	  
  while(i--)
  {
    if(cmd&0x80)
      LCD_SDA(1);
    else
      LCD_SDA(0);
    LCD_SCL(1);
    delayus(1);	            
    LCD_SCL(0);    
    cmd<<=1;;   
  }
}

void LCD_Set_Pos(unsigned char x, unsigned char y)
{ 
  LCD_WrCmd(0xb0+y);
  LCD_WrCmd(((x&0xf0)>>4)|0x10);
  LCD_WrCmd((x&0x0f)); 
}

static void oled_clear(void)
{
  unsigned char y,x;	
  for(y=0;y<8;y++)
  {
    LCD_WrCmd(0xb0+y);
    LCD_WrCmd(0x01);
    LCD_WrCmd(0x10); 
    for(x=0;x<OLED_WIDTH;x++)
      oled.ops->data(0);
  }
}

static void oled_init(void)        
{ 
  //-----端口初始化----//
  CLOCK_EnableClock(kCLOCK_Iomuxc);           // IO口时钟使能

  IOMUXC_SetPinMux(LCD_DC_PINMUX, 0U);   //E11
  IOMUXC_SetPinMux(LCD_RST_PINMUX, 0U);   //E12
  IOMUXC_SetPinMux(LCD_SDA_PINMUX, 0U);   //D12
  IOMUXC_SetPinMux(LCD_SCL_PINMUX, 0U);   //D11
  
  IOMUXC_SetPinConfig(LCD_DC_PINMUX,0x10B0u); 
  IOMUXC_SetPinConfig(LCD_RST_PINMUX,0x10B0u);
  IOMUXC_SetPinConfig(LCD_SDA_PINMUX,0x10B0u);
  IOMUXC_SetPinConfig(LCD_SCL_PINMUX,0x10B0u);
  
  gpio_pin_config_t GPIO_Output_Config = {kGPIO_DigitalOutput, //GPIO为输出方向
                                          0,                   //低电平
                                          kGPIO_NoIntmode      //非中断模式
                                          };  
  GPIO_PinInit(LCD_DC_GPIO, LCD_DC_PIN, &GPIO_Output_Config);
  GPIO_PinInit(LCD_RST_GPIO, LCD_RST_PIN, &GPIO_Output_Config);      
  GPIO_PinInit(LCD_SDA_GPIO, LCD_SDA_PIN, &GPIO_Output_Config);  
  GPIO_PinInit(LCD_SCL_GPIO, LCD_SCL_PIN, &GPIO_Output_Config);      
 
  
  LCD_SCL(1);
  LCD_RST(0);
  delayms(50);
  LCD_RST(1);
  
  LCD_WrCmd(0xae);//--turn off oled panel
  LCD_WrCmd(0x00);//---set low column address
  LCD_WrCmd(0x10);//---set high column address
  LCD_WrCmd(0x40);//--set start line address  Set Mapping RAM Display Start Line (0x00~0x3F)
  LCD_WrCmd(0x81);//--set contrast control register
  LCD_WrCmd(0xcf); // Set SEG Output Current Brightness
  LCD_WrCmd(0xa1);//--Set SEG/Column Mapping     0xa0左右反置 0xa1正常
  LCD_WrCmd(0xc8);//Set COM/Row Scan Direction   0xc0上下反置 0xc8正常
  LCD_WrCmd(0xa6);//--set normal display
  LCD_WrCmd(0xa8);//--set multiplex ratio(1 to 64)
  LCD_WrCmd(0x3f);//--1/64 duty
  LCD_WrCmd(0xd3);//-set display offset	Shift Mapping RAM Counter (0x00~0x3F)
  LCD_WrCmd(0x00);//-not offset
  LCD_WrCmd(0xd5);//--set display clock divide ratio/oscillator frequency
  LCD_WrCmd(0x80);//--set divide ratio, Set Clock as 100 Frames/Sec
  LCD_WrCmd(0xd9);//--set pre-charge period
  LCD_WrCmd(0xf1);//Set Pre-Charge as 15 Clocks & Discharge as 1 Clock
  LCD_WrCmd(0xda);//--set com pins hardware configuration
  LCD_WrCmd(0x12);
  LCD_WrCmd(0xdb);//--set vcomh
  LCD_WrCmd(0x40);//Set VCOM Deselect Level
  LCD_WrCmd(0x20);//-Set Page Addressing Mode (0x00/0x01/0x02)
  LCD_WrCmd(0x02);//
  LCD_WrCmd(0x8d);//--set Charge Pump enable/disable
  LCD_WrCmd(0x14);//--set(0x10) disable
  LCD_WrCmd(0xa4);// Disable Entire Display On (0xa4/0xa5)
  LCD_WrCmd(0xa6);// Disable Inverse Display On (0xa6/a7) 
  LCD_WrCmd(0xaf);//--turn on oled panel
  oled.ops->clear();
  LCD_njust();
  delayms(800);
  oled.ops->clear();
  LCD_Set_Pos(0,0);  
} 

//==============================================================
//函数名：LCD_P6x8Str(unsigned char x,unsigned char y,unsigned char *p)
//功能描述：写入一组标准ASCII字符串
//参数：显示的位置（x,y），y为页范围0～7，要显示的字符串
//返回：无
//==============================================================
void LCD_P6x8Str(unsigned char x,unsigned char y,unsigned char ch[])
{
  unsigned char c=0,i=0,j=0;      
  while (ch[j]!='\0')
  {    
    c =ch[j]-32;
    if(x>126)
    {
      x=0;
      y++;
    }
    LCD_Set_Pos(x,y);    
    for(i=0;i<6;i++)     
      oled.ops->data(oeld_char_lib6x8[c][i]);  
    x+=6;
    j++;
  }
}

//==============================================================
//函数名： void LCD_PutPixel(unsigned char x,unsigned char y)
//功能描述：绘制一个点（x,y）
//参数：真实坐标值(x,y),x的范围0～127，y的范围0～64
//返回：无
//==============================================================
void LCD_PutPixel(unsigned char x,unsigned char y)
{
  unsigned char data1;  //data1当前点的数据 
  
  LCD_Set_Pos(x,(unsigned char)(y>>3)); 
  data1 =(unsigned char)(0x01<<(y%8)); 	
  LCD_WrCmd((unsigned char)(0xb0+(y>>3)));
  LCD_WrCmd((unsigned char)(((x&0xf0)>>4)|0x10));
  LCD_WrCmd((unsigned char)((x&0x0f)|0x00));
  oled.ops->data(data1); 	 	
}
//==============================================================
//函数名： void LCD_Rectangle(unsigned char x1,unsigned char y1,
//                   unsigned char x2,unsigned char y2,unsigned char color,unsigned char gif)
//功能描述：绘制一个实心矩形
//参数：左上角坐标（x1,y1）,右下角坐标（x2，y2）
//      其中x1、x2的范围0～127，y1，y2的范围0～63，即真实坐标值
//返回：无
//==============================================================
void LCD_Rectangle(unsigned char x1,unsigned char y1,unsigned char x2,unsigned char y2,unsigned char gif)
{
  unsigned char n; 
  
  LCD_Set_Pos(x1,y1>>3);
  for(n=x1;n<=x2;n++)
  {
    oled.ops->data(0x01<<(y1%8)); 			
    if(gif == 1) 	delayms(50);
  }  
  LCD_Set_Pos(x1,y2>>3);
  for(n=x1;n<=x2;n++)
  {
    oled.ops->data(0x01<<(y2%8)); 			
    if(gif == 1) 	delayms(5);
  }
  
}  

void LCD_njust(void)
{ 	
  unsigned int ii=0;
  unsigned char x,y;       
  
  for(y=0;y<8;y++)
  {
    LCD_Set_Pos(0,y);				
    for(x=0;x<128;x++)
    {      
      oled.ops->data(njustlogo[ii++]);	    	
    }
  }
}

void LCD_PrintFloat(unsigned char x,unsigned char y,float num)
{
  unsigned char tmp[6],i;
  tmp[5]=0;
  num *= 10;
  if(num>0)
  {
    tmp[0]='+';
    tmp[4]=(unsigned char)((int)num%10+0x30);
    tmp[3]=(unsigned char)((int)num/10%10+0x30);
    tmp[2]=(unsigned char)((int)num/100%10+0x30);
    tmp[1]=(unsigned char)((int)num/1000%10+0x30);
  }
  else
  {
    tmp[0]='-';
    num=-num;
    tmp[4]=(unsigned char)((int)num%10+0x30);
    tmp[3]=(unsigned char)((int)num/10%10+0x30);
    tmp[2]=(unsigned char)((int)num/100%10+0x30);
    tmp[1]=(unsigned char)((int)num/1000%10+0x30);
  }
  for(i=0;i<4;i++)
  {
    if(tmp[i]=='0')
      tmp[i]=' ';
    else
      break;
  }
  LCD_P6x8Str(x,y,tmp);
}

void LCD_Show_Frame94(void)
{
  LCD_Set_Pos(1,2);
  oled.ops->data(0xFF); 
  LCD_Set_Pos(1,3);
  oled.ops->data(0xFF); 
  LCD_Set_Pos(1,4);
  oled.ops->data(0xFF); 
  LCD_Set_Pos(1,5);
  oled.ops->data(0xFF);
  LCD_Set_Pos(1,6);
  oled.ops->data(0xFF);
  LCD_Set_Pos(1,7);
  oled.ops->data(0xFF);

  LCD_Set_Pos(96,2);
  oled.ops->data(0xFF); 
  LCD_Set_Pos(96,3);
  oled.ops->data(0xFF); 
  LCD_Set_Pos(96,4);
  oled.ops->data(0xFF); 
  LCD_Set_Pos(96,5);
  oled.ops->data(0xFF);
  LCD_Set_Pos(96,6);
  oled.ops->data(0xFF);
  LCD_Set_Pos(96,7);
  oled.ops->data(0xFF);
}

